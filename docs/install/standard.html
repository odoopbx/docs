
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Standard installation &#8212; OdooPBX 1.0 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="standard-installation">
<h1>Standard installation<a class="headerlink" href="#standard-installation" title="Permalink to this headline">¶</a></h1>
<p>This method describes how to install OdooPBX on a Linux server.</p>
<p>Also the previous step <a class="reference internal" href="system.html"><span class="doc">System requirements</span></a> must be done.</p>
<p>OdooPBX has the following components:</p>
<ul class="simple">
<li><p>Odoo &amp; PostgreSQL</p></li>
<li><p>Asterisk PBX</p></li>
<li><p>The Agent.</p></li>
</ul>
<p>Let review them in more details.</p>
<div class="section" id="all-in-one-demo">
<h2>All-in-one demo<a class="headerlink" href="#all-in-one-demo" title="Permalink to this headline">¶</a></h2>
<p>Below commands will install a full <strong>all-in-one</strong> demo system:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>pip3 install odoopbx
odoopbx install odoopbx
</pre></div>
</div>
</div>
<div class="section" id="the-agent">
<h2>The Agent<a class="headerlink" href="#the-agent" title="Permalink to this headline">¶</a></h2>
<p>This is where all starts. To start your OdooPBX journey you must first install the OdooPBX Agent.</p>
<p>The Agent does the following jobs:</p>
<ul class="simple">
<li><p>Forwards Asterisk events to Odoo according to the downloaded events map.</p></li>
<li><p>Executes Asterisk actions received from Odoo.</p></li>
<li><p>Protects Asterisk from DDoS and password bruteforce attacks.</p></li>
<li><p>Manages the installation &amp; upgrade process.</p></li>
</ul>
<p>The Agent itself is built upon the Saltstack platform. So if you come the Salt world - welcome home, dude!</p>
<p>The Agent uses Salt states files to install different OdooPBX components.
The following components are available:</p>
<ul class="simple">
<li><p><strong>odoo</strong> - Odoo server.</p></li>
<li><p><strong>addons</strong> - <a class="reference external" href="https://github.com/odoopbx/addons">Public OdooPBX modules</a>.</p></li>
<li><p><strong>postgres</strong> - PostgreSQL database.</p></li>
<li><p><strong>agent</strong> - Salt minion, api and master processes.</p></li>
<li><p><strong>asterisk</strong> - Asterisk PBX server.</p></li>
<li><p><strong>nginx</strong> - the Nginx proxy server.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please note that the Agent requires root privileges. The commands below must be run as the <strong>root</strong> user.</p>
</div>
<p>To install a compoment the following command is used:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>odoopbx install agent
odoopbx install odoo
odoopbx install addons
odoopbx install asterisk
odoopbx install nginx
</pre></div>
</div>
<p>To install all compoments use this:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>odoopbx install odoopbx
</pre></div>
</div>
<p>Different components can be installed into different servers and be interconnected easily.</p>
<p>But it’s not a good idea to put all eggs in one busket, especially the PBX egg that is actually
a real-time application that likes dedicated resources.</p>
<p>So the most common setup uses two servers:</p>
<ul class="simple">
<li><p>1: Odoo, PostgreSQL, Nginx.</p></li>
<li><p>2: Asterisk, The Agent.</p></li>
</ul>
<p>The best place to install the Agent is the same server where Asterisk runs because in this case
it has direct access to local file system  and can access call recordings.</p>
<p>If you don’t need call recordings in Odoo you can setup the Asterisk agent on a different computer but
it is advised to place it at least near the Asterisk server. But depending on your company size you can also
have your Asterisk in America and Odoo in Europe datacenter.</p>
</div>
<div class="section" id="odoo-installation">
<h2>Odoo installation<a class="headerlink" href="#odoo-installation" title="Permalink to this headline">¶</a></h2>
<p>If you don’t have Odoo installed you can use the Agent to deploy Odoo on the current host.
.. code:: sh</p>
<blockquote>
<div><p>odoopbx install odoo</p>
</div></blockquote>
<p>This will install Odoo in a system wide python path with configuration file in <code class="docutils literal notranslate"><span class="pre">/etc/odoo/odoo.conf</span></code>.</p>
<p>You can start Odoo with:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>systemctl start odoo
</pre></div>
</div>
<p>To see the Odoo log do:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>journalctl -u odoo -f
</pre></div>
</div>
</div>
<div class="section" id="odoo-configuration">
<h2>Odoo configuration<a class="headerlink" href="#odoo-configuration" title="Permalink to this headline">¶</a></h2>
<p>Odoo should be configured in the right way in order to be ready for Asterisk Plus.</p>
<p>When the Agent is used to install Odoo all is setup automatically by it. Read below only if you have
your own Odoo server deployed somewhere.</p>
<div class="section" id="workers">
<h3>Workers<a class="headerlink" href="#workers" title="Permalink to this headline">¶</a></h3>
<p>Workers are Odoo processes that handle requests.</p>
<p>Asterisk modules make many short-running requests.</p>
<p>So your Odoo should be configured with at least 2 workers
(but 4 workers is the minimal recommended starting value).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you use odoo.sh with 1 worker configured it is possible to get issues related to performance.</p>
</div>
</div>
<div class="section" id="long-polling">
<h3>Long polling<a class="headerlink" href="#long-polling" title="Permalink to this headline">¶</a></h3>
<p>Internal gevent-based server must be enabled (aka long polling) for popup notifications
and live channels reload to work.</p>
<p>When you enable workers gevent server is also enabled.</p>
<p>By default port 8072 is used and you can check it with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">netstat</span> <span class="o">-</span><span class="n">an</span> <span class="o">|</span> <span class="n">grep</span> <span class="n">LISTEN</span> <span class="o">|</span> <span class="n">grep</span> <span class="mi">8072</span>
</pre></div>
</div>
<p>on your Odoo server.</p>
<p>If you don’t use a proxy (apache / nginx / etc) then you should open Odoo
on gevent’s port e.g.: <code class="docutils literal notranslate"><span class="pre">http://127.0.0.1:8072/web</span></code>.</p>
<p>If you run Odoo behind a proxy be sure to add a different proxy handler for the <code class="docutils literal notranslate"><span class="pre">/longpolling/poll</span></code> URL.</p>
<p>Here is a snippet for Nginx:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">location</span> <span class="o">/</span><span class="n">longpolling</span><span class="o">/</span><span class="n">poll</span> <span class="p">{</span>
  <span class="n">proxy_pass</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">8072</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If you see <code class="docutils literal notranslate"><span class="pre">Exception:</span> <span class="pre">bus.Bus</span> <span class="pre">unavailable</span></code> in your Odoo log then it means you
did not set long polling right.</p>
</div>
<div class="section" id="single-multi-database-setup">
<h3>Single / multi database setup<a class="headerlink" href="#single-multi-database-setup" title="Permalink to this headline">¶</a></h3>
<p>There is one thing your should know.</p>
<p>It’s a good configuration when your Odoo is limited to just one database with dbfilter
configuration option and list_db set to False.</p>
<p>But when you run Odoo with multiple databases some special configuration must be enabled.</p>
<p>You should add asterisk_plus to <code class="docutils literal notranslate"><span class="pre">server_wide_modules</span></code> parameter in order to be able
to make CURL requests from the Asterisk dialplan (see below).</p>
<p>Here is an example of such a configuration line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">server_wide_modules</span> <span class="o">=</span> <span class="n">web</span><span class="p">,</span><span class="n">asterisk_plus</span>
</pre></div>
</div>
<p>If your Odoo is in a single-mode setup there is no need to configure the <code class="docutils literal notranslate"><span class="pre">server_wide_modules</span></code> parameter.</p>
</div>
</div>
<div class="section" id="addons">
<h2>Addons<a class="headerlink" href="#addons" title="Permalink to this headline">¶</a></h2>
<p>To install the OdooPBX public addons use:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>odoopbx install addons
</pre></div>
</div>
<p>Or follow this instruction to copy OdooPBX addons to your custom Odoo server.</p>
<p>Install <a class="reference external" href="https://github.com/odoopbx/addons">addons</a> in the same way you install any other Odoo module.</p>
<p>Do a database backup before installation or upgrade and also make a backup of previous version of the module
if you have it (just in case to be able to restore quicky).</p>
<p>Make sure that <code class="docutils literal notranslate"><span class="pre">addons_path</span></code> is set correctly to include OdooPBX addons.</p>
<p>The module dependencies are localed in <code class="docutils literal notranslate"><span class="pre">requirements.txt</span></code> file located in the addons folder.</p>
<p>If you use odoo.sh make sure you copy the requirements to your modules top folder so that odoo.sh can
install the required dependencies.</p>
<p>If you use python virtualenv make sure you install the requirements there and not system wide.</p>
</div>
<div class="section" id="asterisk">
<h2>Asterisk<a class="headerlink" href="#asterisk" title="Permalink to this headline">¶</a></h2>
<p>To install Asterisk on the current server run:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>odoopbx install asterisk
</pre></div>
</div>
<p>This will build Asterisk from the sources and also create default OdooPBX related configuration files.</p>
<p>If you use your own Asterisk server read the below instuction.</p>
<p>Prepare an Asterisk Manager Interface (AMI) account to allow the Agent to connect to Asterisk.</p>
<p>Vanilla Asterisk requires editing the  <code class="docutils literal notranslate"><span class="pre">manager.conf</span></code> file, which is usually found in <code class="docutils literal notranslate"><span class="pre">/etc/asterisk</span></code>.</p>
<p>A sample configuration is provided below, which lets the Agent to connect
to your Asterisk server AMI port (usually 5038) using the login <code class="docutils literal notranslate"><span class="pre">odoo</span></code> with the password <code class="docutils literal notranslate"><span class="pre">odoo</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">manager.conf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">general</span><span class="p">]</span>
<span class="n">enabled</span> <span class="o">=</span> <span class="n">yes</span>
<span class="n">webenabled</span> <span class="o">=</span> <span class="n">no</span> <span class="p">;</span> <span class="n">Asterisk</span> <span class="n">calls</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">use</span> <span class="n">HTTP</span> <span class="n">interface</span>
<span class="n">port</span> <span class="o">=</span> <span class="mi">5038</span>
<span class="n">bindaddr</span> <span class="o">=</span> <span class="mf">127.0.0.1</span>

<span class="p">[</span><span class="n">odoo</span><span class="p">]</span>
<span class="n">secret</span><span class="o">=</span><span class="n">odoo</span>
<span class="n">displayconnects</span> <span class="o">=</span> <span class="n">yes</span>
<span class="n">read</span><span class="o">=</span><span class="nb">all</span>
<span class="n">write</span><span class="o">=</span><span class="nb">all</span>
<span class="n">deny</span><span class="o">=</span><span class="mf">0.0.0.0</span><span class="o">/</span><span class="mf">0.0.0.0</span>
<span class="n">permit</span><span class="o">=</span><span class="mf">127.0.0.1</span><span class="o">/</span><span class="mf">255.255.255.0</span>
</pre></div>
</div>
<p>Asterisk-based distributions such as <strong>FreePBX</strong>  offer a web GUI interface for managing your
AMI users. You can use that interface to create one, or you can add the account configuration data in
a custom file, which will not be managed by the distro, usually <code class="docutils literal notranslate"><span class="pre">/etc/asterisk/manager_custom.conf</span></code></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>For security reasons always use deny/permit options in your manager.conf.
Change permit option to IP address of your Asterisk server if agent is not started on the same box.</p>
</div>
<p>Make sure that you applied new configuration by checking the Asterisk console:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">manager</span> <span class="n">show</span> <span class="n">user</span> <span class="n">odoo</span>
</pre></div>
</div>
</div>
<div class="section" id="the-agent-configuration">
<h2>The Agent Configuration<a class="headerlink" href="#the-agent-configuration" title="Permalink to this headline">¶</a></h2>
<p>The Agent local configuration file is located in <code class="docutils literal notranslate"><span class="pre">/etc/salt/minion_local.conf</span></code>.</p>
<p>The defaults are located in <code class="docutils literal notranslate"><span class="pre">/etc/salt/minion.d/odoopbx.conf</span></code>.</p>
<p>When you add an option to the local configuration it overwrites the default value.</p>
<div class="section" id="odoo-settings">
<h3>Odoo settings<a class="headerlink" href="#odoo-settings" title="Permalink to this headline">¶</a></h3>
<p>First configure the Agent’s connection to Odoo:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">odoo_host</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">odoo</span> <span class="c1"># Put IP address or hostname here.</span>
<span class="nt">odoo_port</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">8069</span> <span class="c1"># If your Odoo is behind a proxy put 80 or 443 here.</span>
<span class="nt">odoo_user</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">asterisk1</span> <span class="c1"># It&#39;s ok to leave the default user name.</span>
<span class="nt">odoo_password</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">asterisk1</span> <span class="c1"># This is the default password set on addon installation. CHANGE IT!!!</span>
<span class="nt">odoo_use_ssl</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">False</span> <span class="c1"># Set to true if your proxy servers HTTPS requests.</span>
<span class="nt">odoo_db</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">odoopbx_14</span> <span class="c1"># Put your database here</span>
</pre></div>
</div>
</div>
<div class="section" id="asterisk-ami-settings">
<h3>Asterisk AMI settings<a class="headerlink" href="#asterisk-ami-settings" title="Permalink to this headline">¶</a></h3>
<p>Configure the Agent for Asterisk connection.
Make sure you applied the Asterisk manager configuration first.</p>
<p>Once you are sure the Odoo AMI user is operational add the following options
to configure the Agent’s connection to your Asterisk:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ami_host</span><span class="p">:</span> <span class="mf">127.0.0.1</span>
<span class="n">ami_port</span><span class="p">:</span> <span class="mi">5038</span>
<span class="n">ami_login</span><span class="p">:</span> <span class="n">odoo</span> <span class="c1"># Put here AMI user name you created in manager.conf.</span>
<span class="n">ami_secret</span><span class="p">:</span> <span class="n">odoo</span> <span class="c1"># Put here AMI user password.</span>
</pre></div>
</div>
<p>Check <code class="docutils literal notranslate"><span class="pre">/etc/salt/minion_local.conf</span></code> to check that everything looks like expected.</p>
</div>
</div>
<div class="section" id="agent-test-run">
<h2>Agent test run<a class="headerlink" href="#agent-test-run" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">salt</span><span class="o">-</span><span class="n">minion</span> <span class="o">-</span><span class="n">l</span> <span class="n">info</span>
</pre></div>
</div>
<p>Check the output printed on the screen. There should be no errors on start.
You should see messages that confirm both Odoo connection and Asterisk connection as shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">INFO</span>    <span class="p">]</span> <span class="n">salt</span><span class="o">.</span><span class="n">loaded</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">engines</span><span class="o">.</span><span class="n">odoo_executor</span><span class="p">:</span><span class="mi">48</span> <span class="n">Logged</span> <span class="n">into</span> <span class="n">Odoo</span><span class="o">.</span>
<span class="o">*</span> <span class="o">*</span> <span class="o">*</span>
<span class="p">[</span><span class="n">INFO</span>    <span class="p">]</span> <span class="n">salt</span><span class="o">.</span><span class="n">loaded</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">engines</span><span class="o">.</span><span class="n">asterisk_ami</span><span class="p">:</span><span class="mi">69</span> <span class="n">AMI</span> <span class="n">connecting</span> <span class="n">to</span> <span class="n">odoo</span><span class="o">@</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mf">5038.</span><span class="o">..</span>
<span class="p">[</span><span class="n">INFO</span>    <span class="p">]</span> <span class="n">salt</span><span class="o">.</span><span class="n">loaded</span><span class="o">.</span><span class="n">ext</span><span class="o">.</span><span class="n">engines</span><span class="o">.</span><span class="n">asterisk_ami</span><span class="p">:</span><span class="mi">72</span> <span class="n">Registering</span> <span class="k">for</span> <span class="n">AMI</span> <span class="n">event</span> <span class="o">*</span>
</pre></div>
</div>
<p>Now stop it with CTRL+C and run it as a service:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">systemctl</span> <span class="n">start</span> <span class="n">salt</span><span class="o">-</span><span class="n">minion</span>
</pre></div>
</div>
</div>
<div class="section" id="asterisk-dialplan-configuration">
<h2>Asterisk Dialplan configuration<a class="headerlink" href="#asterisk-dialplan-configuration" title="Permalink to this headline">¶</a></h2>
<p>Asterisk Plus exposes additional functionality by providing the following controllers:</p>
<ol class="arabic simple">
<li><p>You can get the contact’s name by accessing <code class="docutils literal notranslate"><span class="pre">asterisk_plus/get_caller_name?number=${CALLERID(number)}</span></code></p></li>
<li><p>If the Contact for the phone number has a manager set, use <code class="docutils literal notranslate"><span class="pre">asterisk_plus/get_partner_manager?number=${CALLERID(number)}</span></code> to get the manager’s number</p></li>
<li><p>You can get the Contact’s tags by using <code class="docutils literal notranslate"><span class="pre">/asterisk_plus/get_caller_tags?number=${CALLERID(number)}</span></code></p></li>
</ol>
<p>Here are some examples of integration, using Asterisk dialplans.</p>
<p><code class="docutils literal notranslate"><span class="pre">extensions.conf</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[globals]
ODOO_URL=http://odoo:8069

; Set connection options for curl.
[sub-setcurlopt]
exten =&gt; _X.,1,Set(CURLOPT(conntimeout)=3)
exten =&gt; _X.,n,Set(CURLOPT(dnstimeout)=3)
exten =&gt; _X.,n,Set(CURLOPT(httptimeout)=3)
exten =&gt; _X.,n,Set(CURLOPT(ssl_verifypeer)=0)
exten =&gt; _X.,n,Return

; Partner&#39;s extension click2call e.g. +1234567890##101
[post-dial-send-dtmf]
exten =&gt; s,1,NoOp(DTMF digits: ${dtmf_digits})
same =&gt; n,ExecIf($[&quot;${dtmf_digits}&quot; = &quot;&quot;]?Return)
same =&gt; n,Wait(${dtmf_delay})
same =&gt; n,SendDTMF(${dtmf_digits})
same =&gt; n,Return


;Set Caller ID name from Odoo
; Get caller ID name from Odoo, replace odoo to your Odoo&#39;s hostname / IP address
; Arguments:
; - number: calling number, strip + if comes with +.
; - db: Odoo&#39;s database name, ommit if you have one db or use dbfilter.
; - country: 2 letters country code, See https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2
; If country code is omitted Asterisk Agent&#39;s Odoo account&#39;s country settings will be used for phonenumbers parsing.

[sub-setcallerid]
exten =&gt; _X.,1,Gosub(sub-setcurlopt,${EXTEN},1)
;   You need to cut leading + on numbers incoming from trunks before passing it to get_caller_name.
exten =&gt; _X.,n,Set(CALLERID(name)=${CURL(${ODOO_URL}/asterisk_plus/get_caller_name?number=${CALLERID(number)})})
exten =&gt; _X.,n,Return


; Get partner’s manager (salesperson) channel

[sub-dialmanager]
exten =&gt; _X.,1,Set(manager_channel=${CURL(${ODOO_URL}/asterisk_plus/get_partner_manager?number=${CALLERID(number)})})
exten =&gt; _X.,n,ExecIf($[&quot;${manager_channel}&quot; != &quot;&quot;]?Dial(${manager_channel}/${EXTEN},60,t))
exten =&gt; _X.,n,Return

; Get partner&#39;s tags to create a special call routing (e.g. VIP queue)
; You can also get caller tags from Odoo with the following controller Here is an example:

; Partner tags
; VIP - tag name in this example.

[partner-vip-tag-lookup]
exten =&gt; _X.,1,Set(CURLOPT(conntimeout)=3)
exten =&gt; _X.,n,Set(CURLOPT(dnstimeout)=3)
exten =&gt; _X.,n,Set(CURLOPT(httptimeout)=3)
exten =&gt; _X.,n,Set(CURLOPT(ssl_verifypeer)=0)
exten =&gt; _X.,n,Set(tags=${CURL(${ODOO_URL}/asterisk_plus/get_caller_tags?number=${CALLERID(number)})})
exten =&gt; _X.,n,NoOp(Tags: ${tags})
exten =&gt; _X.,n,Set(match=${REGEX(&quot;VIP&quot; ${tags})})
exten =&gt; _X.,n,NoOp(Match: ${match})
exten =&gt; _X.,n,Return(${match})

; Check VIP tag
[check-vip]
exten =&gt; _X.,1,Gosub(partner-vip-tag-lookup,${EXTEN},1,VIP)
exten =&gt; _X.,n,GotoIf($[&quot;${GOSUB_RETVAL}&quot; = &quot;1&quot;]?vip-queue,${EXTEN},1)


; Incoming call handling

[from-sip-external]
exten =&gt; _X.,1,Gosub(sub-setcallerid,${EXTEN},1) ; Set partner&#39;s caller name
exten =&gt; _X.,n,MixMonitor(${UNIQUEID}.wav) ; Record call
exten =&gt; _X.,n,Gosub(sub-dialmanager,${EXTEN},1) ; Try to connect to manager
; Put here some login to handle if manager channel is busy for example put in the queue.
exten =&gt; _X.,n,Queue(sales)

[from-internal]
exten =&gt; _X.,1,MixMonitor(${UNIQUEID}.wav) ; Activate call recording.
exten =&gt; _XXXX,2,Dial(SIP/${EXTEN},30) ; Local users calling
exten =&gt; _XXXXX.,2,Dial(SIP/provider/${EXTEN},30,TU(post-dial-send-dtmf) ; Outgoing calls pattern
</pre></div>
</div>
<p>That’s all for now!</p>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../index.html">OdooPBX</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">What is OdooPBX?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html#odoopbx-apps">OdooPBX Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html#installation-types">Installation types</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../administration.html">Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common.html">Common</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Odooist.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.5.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>